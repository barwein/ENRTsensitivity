% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sa_single_iter.R
\name{SA_one_iter}
\alias{SA_one_iter}
\title{Run a Single Iteration of the Sensitivity Analysis}
\usage{
SA_one_iter(
  Y_e,
  Y_a,
  X_e = NULL,
  X_a = NULL,
  Z_e,
  F_a,
  ego_id_a,
  reg_model_egos,
  reg_model_alters,
  formula_egos,
  formula_alters,
  pi_list_ego_ego,
  pi_list_alter_ego,
  kappa_vec,
  pz,
  n_folds = 2,
  estimate_var = FALSE,
  ...
)
}
\arguments{
\item{Y_e}{A numeric vector of outcomes for the egos.}

\item{Y_a}{A numeric vector of outcomes for the alters.}

\item{X_e}{A numeric matrix of covariates for the egos.}

\item{X_a}{A numeric matrix of covariates for the alters.}

\item{Z_e}{A binary numeric vector (0 or 1) of treatment assignments for egos.}

\item{F_a}{A binary numeric vector (0 or 1) of `observed` exposures for alters.}

\item{ego_id_a}{A numeric vector mapping each alter to their ego's index
(1 to n_e). Required for IE variance.}

\item{reg_model_egos}{A function for the egos' outcome regression model.}

\item{reg_model_alters}{A function for the alters' outcome regression model.}

\item{formula_egos}{A formula for the egos' regression model.}

\item{formula_alters}{A formula for the alters' regression model.}

\item{pi_list_ego_ego}{A list where each element is a vector of exposure
probabilities (`pi_i^e`) for egos.}

\item{pi_list_alter_ego}{A list where each element is a vector of exposure
probabilities (`pi_i^a`) for alters.}

\item{kappa_vec}{A numeric vector of values for the kappa sensitivity parameter.}

\item{pz}{The known probability of an ego being assigned to treatment, Pr(Z=1).}

\item{n_folds}{The number of folds for cross-fitting outcome models.}

\item{estimate_var}{Logical. If TRUE, compute and return empirical variance
estimates. If FALSE, variance columns will be NA.}

\item{...}{Additional arguments passed to the regression model functions.}
}
\value{
A list containing two data.tables:
\describe{
  \item{IE_corrected}{A data.table with columns: `pi_param`, `ie_rd`, `ie_rd_var`}
  \item{DE_corrected}{A data.table with columns: `pi_param`, `kappa`, `de_rd`, `de_rd_var`}
}
}
\description{
This function performs one iteration of the sensitivity analysis for a given
dataset (or bootstrap sample). It first estimates the outcome models using
cross-fitting and then uses those predictions to calculate the augmented,
bias-corrected estimates for IE and DE across a grid of sensitivity parameters.
}
\keyword{internal}
