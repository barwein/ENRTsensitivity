% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sensitivity_params.R
\name{pi_hetero}
\alias{pi_hetero}
\title{Calculate Heterogeneous Exposure Probabilities (pi)}
\usage{
pi_hetero(
  X_e,
  X_a = NULL,
  m_vec = NULL,
  gamma = -1,
  dist = "norm",
  ego_index = NULL,
  pz = 0.5,
  p = 1,
  return_rho_ij = FALSE
)
}
\arguments{
\item{X_e}{A numeric matrix of covariates for the egos (n_e rows).}

\item{X_a}{A numeric matrix of covariates for the alters (n_a rows).
If `NULL`, the function calculates ego-ego probabilities (\eqn{\pi_i^e}).
If provided, it calculates alter-ego probabilities (\eqn{\pi_i^a}).}

\item{m_vec}{A numeric vector of the expected number of missing edges, \eqn{m^e} or
\eqn{m^a}. Used for "Example 4". If `NULL` (default),
the function uses the "Example 3" model.}

\item{gamma}{A numeric vector of sensitivity parameters (\eqn{\gamma^e} or \eqn{\gamma^a})
that control the influence of covariate similarity.
If `m_vec` is provided, `gamma` must be a single scalar.}

\item{dist}{A string specifying the distance function.
Supported: `"norm"` (Lp norm), `"cosine"`, `"inner"`.}

\item{ego_index}{A numeric vector mapping each alter to their ego's index.
Required only when `type_ == "alter"` (i.e., `X_a` is not `NULL`).
This is used to exclude distances to an alter's *own* ego.}

\item{pz}{The known probability of an ego being assigned to treatment, \eqn{Pr(Z=1)}.}

\item{p}{The power for the Lp norm (`dist = "norm"`), e.g., `p=2` for
Euclidean (default) or `p=1` for Manhattan.}

\item{return_rho_ij}{Logical. If `TRUE` and `m_vec` is used, returns a
list containing both the 'pi' vectors and the 'rho' (edge probability)
matrices.}
}
\value{
If `m_vec` is `NULL`: A named list where each element is a *vector*
  of \eqn{\pi_i} values (length n_e or n_a). The names correspond to `gamma` values.
If `m_vec` is not `NULL`: A named list where each element is a *vector*
  of \eqn{\pi_i} values. The names correspond to `m_vec` values.
}
\description{
Calculates the probability of exposure to at least one treated ego (\eqn{\pi_i})
under a heterogeneous contamination model. This model assumes that the
probability of a latent edge depends on unit-level covariates \eqn{X},
typically through a distance or similarity function.

This function generates sensitivity parameters for `enrt_sa` and
`enrt_pba` based on "Example 3 (Heterogeneous probabilities)" and
"Example 4 (Heterogeneous number of missing edges)" from the paper.
}
\examples{
# --- Simulate data for examples ---
set.seed(123)
n_e <- 50
n_a <- 100
pz <- 0.5
X_e <- matrix(rnorm(n_e * 2), ncol = 2, dimnames = list(NULL, c("X1", "X2")))
X_a <- matrix(rnorm(n_a * 2), ncol = 2, dimnames = list(NULL, c("X1", "X2")))
ego_id_a <- sample(1:n_e, n_a, replace = TRUE) # Map alters to egos

# --- Example 3: Heterogeneous Probabilities (Egos) ---
# Calculate pi_e vectors based on covariate similarity (gamma)

pi_e_list_hetero <- pi_hetero(X_e = X_e,
                              gamma = c(0.5, 1.0, 2.0),
                              dist = "norm",
                              p = 2,
                              pz = pz)

# Each element is a vector of length n_e
sapply(pi_e_list_hetero, length)
sapply(pi_e_list_hetero, mean)

# --- Example 4: Heterogeneous Number of Edges (Alters) ---
# Calculate pi_a vectors based on an expected number of missing edges (m_a),
# where edge probability is weighted by covariate similarity (gamma = 1).

pi_a_list_hetero <- pi_hetero(X_e = X_e,
                              X_a = X_a,
                              m_vec = c(50, 100),
                              gamma = 1.0,
                              dist = "norm",
                              ego_index = ego_id_a,
                              p = 2,
                              pz = pz)

# Each element is a vector of length n_a
sapply(pi_a_list_hetero, length)
sapply(pi_a_list_hetero, mean)

}
